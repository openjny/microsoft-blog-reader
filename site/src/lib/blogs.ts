export const BLOG_METADATA: Record<string, { name: string; category: string }> = {
  "accessblog": { name: "Access", category: "Identity" },
  "adformysql": { name: "Azure Database for My SQL", category: "Database" },
  "adforpostgresql": { name: "Azure Database for Postgre SQL", category: "Database" },
  "adsapiblog": { name: "Ads API", category: "PaaS" },
  "aiplatformblog": { name: "AI Platform", category: "AI" },
  "analyticsonazure": { name: "Analytics on Azure", category: "Analytics" },
  "appsonazureblog": { name: "Apps on Azure", category: "PaaS" },
  "askds": { name: "Ask Directory Services", category: "Others" },
  "azure-ai-foundry-blog": { name: "Microsoft Foundry", category: "AI" },
  "azure-ai-services-blog": { name: "Azure AI Services", category: "AI" },
  "azurearcblog": { name: "Azure Arc", category: "Arc" },
  "azurearchitectureblog": { name: "Azure Architecture", category: "Architecture" },
  "azurecommunicationservicesblog": { name: "Azure Communication Services", category: "PaaS" },
  "azurecompute": { name: "Azure Compute", category: "Cloud Infrastructure" },
  "azureconfidentialcomputingblog": { name: "Azure Confidential Computing", category: "PaaS" },
  "azuredatablog": { name: "Azure Data", category: "Data" },
  "azuredataexplorer": { name: "Azure Data Explorer", category: "Data" },
  "azuredatafactoryblog": { name: "Azure Data Factory", category: "Data" },
  "azuredbsupport": { name: "Azure Database Support", category: "Databases" },
  "azuredevcommunityblog": { name: "Microsoft Developer Community", category: "Development" },
  "azurefederaldeveloperconnect": { name: "Azure Federal Developer Connect", category: "Development" },
  "azureforisvandstartupstechnicalblog": { name: "Azure for ISV and Startups Technical", category: "Architecture" },
  "azuregovernanceandmanagementblog": { name: "Azure Governance and Management", category: "Governance" },
  "azurehighperformancecomputingblog": { name: "Azure High Performance Computing", category: "HPC" },
  "azureinfragurus": { name: "Azure Infra Gurus", category: "Cloud Infrastructure" },
  "azureinfrastructureblog": { name: "Azure Infrastructure", category: "Cloud Infrastructure" },
  "azurelabservicesblog": { name: "Azure Lab Services", category: "Others" },
  "azuremapsblog": { name: "Azure Maps", category: "PaaS" },
  "azuremigrationblog": { name: "Azure Migration and Modernization", category: "Others" },
  "azurenetworkingblog": { name: "Azure Networking", category: "Networking" },
  "azurenetworksecurityblog": { name: "Azure Network Security", category: "Networking" },
  "azureobservabilityblog": { name: "Azure Observability", category: "Others" },
  "azurepaasblog": { name: "Azure PaaS", category: "PaaS" },
  "azurepurviewblog": { name: "Azure Purview", category: "Security" },
  "azurespaceblog": { name: "Azure Space", category: "PaaS" },
  "azuresqlblog": { name: "Azure SQL", category: "Database" },
  "azurestackblog": { name: "Azure Stack", category: "Cloud Infrastructure" },
  "azurestorageblog": { name: "Azure Storage", category: "Cloud Infrastructure" },
  "azuresynapseanalyticsblog": { name: "Azure Synapse Analytics", category: "Analytics" },
  "azuretoolsblog": { name: "Azure Tools", category: "Others" },
  "azurevirtualdesktopblog": { name: "Azure Virtual Desktop", category: "Virtualization" },
  "communitynewsdesk": { name: "Community News Desk", category: "Communities" },
  "configurationmanagerblog": { name: "Configuration Manager", category: "Endpoints" },
  "containers": { name: "Containers", category: "Containers" },
  "coreinfrastructureandsecurityblog": { name: "Core Infrastructure and Security", category: "Security" },
  "corporate_communications_blog": { name: "Corporate Communications", category: "Others" },
  "dataarchitectureblog": { name: "Data Architecture", category: "Data" },
  "defenderexternalattacksurfacemgmtblog": { name: "Defender External Attack Surface Mgmt", category: "Security" },
  "defenderthreatintelligence": { name: "Defender Threat Intelligence", category: "Security" },
  "devicemanagementmicrosoft": { name: "Device Management Microsoft", category: "Endpoints" },
  "drivingadoptionblog": { name: "Driving Adoption", category: "Others" },
  "educationblog": { name: "Education", category: "Communities" },
  "educatordeveloperblog": { name: "Educator Developer", category: "Development" },
  "excelblog": { name: "Excel", category: "Productivity" },
  "exchange": { name: "Exchange", category: "Exchange" },
  "fasttrackblog": { name: "Fast Track", category: "Fast Track" },
  "fasttrackforazureblog": { name: "Fast Track for Azure", category: "Fast Track" },
  "filecab": { name: "File CAB", category: "Others" },
  "finopsblog": { name: "FinOps", category: "Finops" },
  "fslogix-blog": { name: "FSLogix", category: "Virtualization" },
  "hardwaredevcenter": { name: "Hardware Dev Center", category: "Hardware" },
  "healthcareandlifesciencesblog": { name: "Healthcare And Life Sciences", category: "Communities" },
  "iis-support-blog": { name: "IIS Support", category: "IIS" },
  "iltcommunicationblog": { name: "ILT Communication", category: "Communities" },
  "integrationsonazureblog": { name: "Integrations on Azure", category: "Others" },
  "intunecustomersuccess": { name: "Intune Customer Success", category: "Endpoints" },
  "iotblog": { name: "IoT", category: "IOT" },
  "itopstalkblog": { name: "IT Ops Talk", category: "ITOPS" },
  "linuxandopensourceblog": { name: "Linux and Open Source", category: "Linux" },
  "m365gcchcommunityhubblog-board": { name: "M365 GCCH Community Hub", category: "Microsoft 365" },
  "machinelearningblog": { name: "Machine Learning", category: "AI" },
  "manufacturing": { name: "Manufacturing", category: "Communities" },
  "marketplace-blog": { name: "Marketplace", category: "Communities" },
  "messagingonazureblog": { name: "Messaging on Azure", category: "Others" },
  "microsoft-entra-blog": { name: "Microsoft Entra", category: "Identity" },
  "microsoft-security-baselines": { name: "Microsoft Security Baselines", category: "Security" },
  "microsoft-security-blog": { name: "microsoft security", category: "Security" },
  "microsoft365businessblog": { name: "Small and Medium Business", category: "Microsoft 365" },
  "microsoft365copilotblog": { name: "Microsoft 365 Copilot", category: "Copilot" },
  "microsoft365insiderblog": { name: "Microsoft 365 Insider", category: "Microsoft 365" },
  "microsoft_365_archive_blog": { name: "Microsoft 365 Archive", category: "Microsoft 365" },
  "microsoft_365_backup_blog": { name: "Microsoft 365 Backup", category: "Microsoft 365" },
  "microsoft_365blog": { name: "Microsoft 365", category: "Microsoft 365" },
  "microsoft_graph_data_connect_for_sharepo": { name: "Microsoft Graph Data Connect for SharePoint", category: "Data" },
  "microsoftdatamigration": { name: "Microsoft Data Migration", category: "Data" },
  "microsoftdefenderatpblog": { name: "Microsoft Defender ATP", category: "Security" },
  "microsoftdefendercloudblog": { name: "Microsoft Defender Cloud", category: "Security" },
  "microsoftdefenderforoffice365blog": { name: "Microsoft Defender for Office 365", category: "Security" },
  "microsoftdefenderiotblog": { name: "Microsoft Defender IoT", category: "Security" },
  "microsoftdeviceecosystemplatformblog": { name: "Microsoft Device Ecosystem Platform", category: "Hardware" },
  "microsoftedgeinsider": { name: "Microsoft Edge Insider", category: "Productivity" },
  "microsoftformsblog": { name: "Microsoft Forms", category: "Productivity" },
  "microsoftindustryblog": { name: "Microsoft Industry", category: "Communities" },
  "microsoftintuneblog": { name: "Microsoft Intune", category: "Endpoints" },
  "microsoftlearnblog": { name: "Microsoft Learn", category: "Communities" },
  "microsoftmechanicsblog": { name: "Microsoft Mechanics", category: "Architecture" },
  "microsoftmissioncriticalblog": { name: "Microsoft Mission Critical", category: "Architecture" },
  "microsoftsecurityexperts": { name: "Microsoft Security Experts", category: "Security" },
  "microsoftsentinelblog": { name: "Microsoft Sentinel", category: "Security" },
  "microsoftteamsblog": { name: "Microsoft Teams", category: "Productivity" },
  "microsoftteamscommunityblog": { name: "Microsoft Teams Community", category: "Productivity" },
  "microsoftteamssupport": { name: "Microsoft Teams Support", category: "Productivity" },
  "microsoftthreatprotectionblog": { name: "Microsoft Defender XDR", category: "Security" },
  "microsoftusbblog": { name: "Microsoft USB", category: "Others" },
  "microsoftvivablog": { name: "Microsoft Viva", category: "Collaboration" },
  "mixed-reality-link": { name: "Mixed reality link", category: "AI" },
  "modernizationbestpracticesblog": { name: "Modernization Best Practices", category: "PaaS" },
  "modernworkappconsult": { name: "Modern Work App Consult", category: "PaaS" },
  "mvp-blog": { name: "Microsoft MVP Program", category: "Communities" },
  "networkingblog": { name: "Networking", category: "Networking" },
  "nonprofittechies": { name: "Non profit Techies", category: "Communities" },
  "office365businessappsblog": { name: "Office 365 Business Apps", category: "Microsoft 365" },
  "officeeos": { name: "Office End Of Support", category: "Productivity" },
  "onedriveblog": { name: "Microsoft One Drive", category: "Productivity" },
  "oracleonazureblog": { name: "Oracle on Azure", category: "Database" },
  "outlook": { name: "Outlook", category: "Outlook" },
  "partnermarketingasaserviceblog-board": { name: "Partner Marketing as a Service", category: "Partners" },
  "partnernews": { name: "Partner News", category: "Partners" },
  "plannerblog": { name: "Planner", category: "Productivity" },
  "projectblog": { name: "Project", category: "Productivity" },
  "projectsupport": { name: "Project Support", category: "Productivity" },
  "publicsectorblog": { name: "Public Sector", category: "Communities" },
  "sapapplications": { name: "SAP Applications", category: "SAP" },
  "securitycopilotblog": { name: "Microsoft Security Copilot", category: "Copilot" },
  "sharepoint_embedded": { name: "Share Point Embedded", category: "Productivity" },
  "sharepoint_premium_blog": { name: "Share Point Premium", category: "Productivity" },
  "skype_for_business_blog": { name: "Skype for Business", category: "Productivity" },
  "smallbasic": { name: "Small Basic", category: "Others" },
  "spblog": { name: "Microsoft SharePoint", category: "Others" },
  "sqlserver": { name: "SQL Server", category: "Database" },
  "sqlserversupport": { name: "SQLServer Support", category: "Database" },
  "ssis": { name: "SSIS", category: "Database" },
  "startupsatmicrosoftblog": { name: "Startups at Microsoft", category: "Architecture" },
  "streamblog": { name: "Stream", category: "Productivity" },
  "studentdeveloperblog": { name: "Student Developer", category: "Development" },
  "surfaceitpro": { name: "Surface IT Pro", category: "Hardware" },
  "sysinternals-blog": { name: "Sysinternals", category: "SysInternal" },
  "systemcenterblog": { name: "System Center", category: "Endpoints" },
  "teamsfreeblog": { name: "Microsoft Teams (free)", category: "Productivity" },
  "themixedrealityblog": { name: "The Mixed Reality", category: "AI" },
  "viva_amplify_blog": { name: "Viva Amplify", category: "Collaboration" },
  "viva_connections_blog": { name: "Viva Connections", category: "Collaboration" },
  "viva_engage_blog": { name: "Viva Engage", category: "Collaboration" },
  "viva_glint_blog": { name: "Viva Glint", category: "Collaboration" },
  "viva_glint_partnersblog-board": { name: "Viva Glint Partnersblog board", category: "Collaboration" },
  "viva_insights_blog": { name: "Viva Insights", category: "Collaboration" },
  "viva_learning_blog": { name: "Viva Learning", category: "Collaboration" },
  "vivapulse-blog": { name: "Viva Pulse", category: "Collaboration" },
  "vivasales-blog": { name: "Viva Sales", category: "Collaboration" },
  "vulnerability-management": { name: "Vulnerability Management", category: "Security" },
  "weeklyroundupblog": { name: "Weekly Roundup", category: "Others" },
  "windows-admin-center-blog": { name: "Windows Admin Center", category: "Windows" },
  "windows-itpro-blog": { name: "Windows IT Pro", category: "Windows" },
  "windowsdriverdev": { name: "Windows Driver Dev", category: "Windows" },
  "windowshardwarecertification": { name: "Windows Hardware Certification", category: "Windows" },
};

/**
 * Manual slug-to-boardId mappings for cases where URL path differs from board.id.
 * Key: normalized URL path slug, Value: board.id key in BLOG_METADATA
 */
const SLUG_ALIASES: Record<string, string> = {
  // URL path has "communications" but board.id has "communication"
  "iltcommunicationsblog": "iltcommunicationblog",
  // "azure-database-support-blog" → "azuredbsupport"
  "azuredatabasesupportblog": "azuredbsupport",
  // "exchange-team-blog" → "exchange"
  "exchangeteamblog": "exchange",
  // "microsoft-foundry-blog" → "azure-ai-foundry-blog"
  "microsoftfoundryblog": "azure-ai-foundry-blog",
  // Other known differences
  "healthcareandlifesciences": "healthcareandlifesciencesblog",
};

/**
 * Normalize a string by removing hyphens, underscores.
 */
function normalizeKey(s: string): string {
  return s.toLowerCase().replace(/[-_]/g, "");
}

/**
 * Get blog metadata by URL path slug or board.id.
 * Returns undefined if not found.
 */
export function getBlogMetadata(
  slug: string
): { name: string; category: string } | undefined {
  const slugLower = slug.toLowerCase();

  // Try direct lookup first
  if (BLOG_METADATA[slugLower]) {
    return BLOG_METADATA[slugLower];
  }

  // Try with hyphens converted to underscores
  const withUnderscores = slugLower.replace(/-/g, "_");
  if (BLOG_METADATA[withUnderscores]) {
    return BLOG_METADATA[withUnderscores];
  }

  // Normalize and check aliases
  const normalized = normalizeKey(slug);
  if (SLUG_ALIASES[normalized]) {
    return BLOG_METADATA[SLUG_ALIASES[normalized]];
  }

  // Fuzzy match on normalized keys
  for (const [key, value] of Object.entries(BLOG_METADATA)) {
    if (normalizeKey(key) === normalized) {
      return value;
    }
  }

  return undefined;
}
